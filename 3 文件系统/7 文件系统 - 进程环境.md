# 进程环境

## 1 main函数
int main(int argc, char **argv)

## 2 进程的终止
正常终止：
- 从main函数返回
- 调用exit 
- 调用 _exit 或 _Exit 
- 最后一个线程从启动例程返回
- 最后一个线程调用pthread_exit

异常终止：
- 调用abort
- 接到一个信号并终止
- 最后一个线程对其取消请求作出响应
	



atexit():钩子函数：所有以atexit和on_exit声明的函数会以他们声明的逆序来调用
	在进程正常终止的时候将被调用（类似于c++析构函数）
用该函数注册过的函数会在程序**正常终止**之前被调用，被注册的函数称为“**钩子函数**”

_exit, _Exit：不会调用钩子函数，也不会做 IO 清理



## 3 命令行参数的分析
```c
// 该函数用于解析短格式参数
getopt()
// 用来解析命令行选项参数
getopt_long()
```

## 4 环境变量

环境变量相当于在某个位置声明 extern char **environ;

```c
getenv() // 取得参数envvar环境变量的内容
setenv() // 改变或添加一个环境变量
putenv() // 用来改变或增加环境变量的内容
```

## 5 C程序的存储空间布局
```
0 - 0x08048000
0x08040800 - 
	text
	已初始化数据段
	未初始化数据段 BSS
	堆
	空白区（最大）：导入动态库和静态库的内容，多半是库的引用相关的内容，静态库导入所占用的空间较大，常用动态库
	栈
	argv & env 
0xC0000000 - 
	
ps axf , pmap ...
```

## 6 库

动态库：文件后缀是.so ，libname.so.x.y.z （lib+共享库名称.so.主版本号.次版本号.发行版本号）,共享函数库中的函数是在当一个可执行程序在启动的时候被加载
静态库：是在程序执行前就加入到目标程序中去了
共享库（手工装载库
```
dlopen // 用于手工装载共享库
dlclose // 用于关闭指定句柄的动态链接库，只有当此动态链接库的使用计数为0时，才会真正被系统卸载
dlerror // 当动态链接库操作函数执行失败时，dlerror可以返回出错信息，返回值为NULL时表示操作函数执行成功
dlsym
```

## 7 函数跳转
setjmp() 设置跳转点
longjmp() 跳转
jmp_buf

## 8 资源的获取以及控制
getrlimit()
setrlimit()

## 9 存储空间分配

```
malloc
calloc
realloc
free
```

